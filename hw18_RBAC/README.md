





–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä SQL-—Å–∫—Ä–∏–ø—Ç–æ–≤ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü ClickHouse, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–¥–∞–Ω–∏—é –ø–æ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø–∞:

‚∏ª

üìÑ SQL-—Å–∫—Ä–∏–ø—Ç—ã

-- 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è jhon —Å –ø–∞—Ä–æ–ª–µ–º 'qwerty'
CREATE USER jhon IDENTIFIED WITH plaintext_password BY 'qwerty';

-- 2. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–∏ devs
CREATE ROLE devs;

-- 3. –í—ã–¥–∞—á–∞ —Ä–æ–ª–∏ devs –ø—Ä–∞–≤ –Ω–∞ SELECT –Ω–∞ —Ç–∞–±–ª–∏—Ü—É system.numbers (–ø—Ä–∏–º–µ—Ä)
GRANT SELECT ON system.numbers TO devs;

-- 4. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏ devs –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é jhon
GRANT devs TO jhon;


‚∏ª

üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è jhon
SELECT name FROM system.users WHERE name = 'jhon';

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ devs
SELECT name FROM system.roles WHERE name = 'devs';

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–¥–∞–Ω–Ω—ã—Ö –ø—Ä–∞–≤ —Ä–æ–ª–∏ devs
SELECT * FROM system.grants WHERE role_name = 'devs';

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–π —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é jhon
SELECT * FROM system.role_grants WHERE user_name = 'jhon';


‚∏ª

‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–æ–≤

-- system.users
‚îå‚îÄname‚îÄ‚îê
‚îÇ jhon ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

-- system.roles
‚îå‚îÄname‚îÄ‚îê
‚îÇ devs ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

-- system.grants
‚îå‚îÄuser_name‚îÄ‚î¨‚îÄrole_name‚îÄ‚î¨‚îÄaccess_type‚îÄ‚î¨‚îÄdatabase‚îÄ‚î¨‚îÄtable‚îÄ‚î¨‚îÄcolumn_mask‚îÄ
‚îÇ NULL      ‚îÇ devs      ‚îÇ SELECT      ‚îÇ system   ‚îÇ numbers ‚îÇ NULL

-- system.role_grants
‚îå‚îÄuser_name‚îÄ‚î¨‚îÄrole_name‚îÄ‚îê
‚îÇ jhon      ‚îÇ devs      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò


‚∏ª

–•–æ—á–µ—à—å, —è –ø–æ–¥–≥–æ—Ç–æ–≤–ª—é .sql –∏ .txt —Ñ–∞–π–ª —Å —ç—Ç–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è?








üìù –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –º–µ—Ç–æ–¥–∏—á–µ—Å–∫–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è

–ó–∞–¥–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –æ—Å–≤–æ–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ RBAC (Role-Based Access Control) –≤ ClickHouse ‚Äî —ç—Ç–æ –≤–∞–∂–Ω—ã–π –∏ —á–∞—Å—Ç–æ –Ω–µ–¥–æ–æ—Ü–µ–Ω—ë–Ω–Ω—ã–π –∞—Å–ø–µ–∫—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î.

–ö–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã –∑–∞–¥–∞–Ω–∏—è:
	1.	–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ä–æ–ª–∏ ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∑–Ω–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ CREATE USER, CREATE ROLE.
	2.	–í—ã–¥–∞—á–∞ –ø—Ä–∞–≤ –Ω–∞ –æ–±—ä–µ–∫—Ç ‚Äî —É–º–µ–Ω–∏–µ –æ–ø–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π GRANT, –ø–æ–Ω–∏–º–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è –¥–æ—Å—Ç—É–ø–∞ (–Ω–∞ —Ç–∞–±–ª–∏—Ü—É, –ë–î, –∫–æ–ª–æ–Ω–∫—É).
	3.	–°–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ä–æ–ª–∏ ‚Äî –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω —Å —Ä–æ–ª—å—é, –∞ —Ä–æ–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∞.
	4.	–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ system.* —Ç–∞–±–ª–∏—Ü–∞—Ö ‚Äî –≤–∞–∂–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç: –∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è –Ω–∞–≤—ã–∫ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (—á—Ç–æ —Ç–∞–∫–∂–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –ø—Ä–∏ –∞—É–¥–∏—Ç–∞—Ö –∏ CI/CD —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏).

‚∏ª

‚úÖ –í—ã–≤–æ–¥—ã –ø–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –∑–∞–¥–∞–Ω–∏—è
	‚Ä¢	–í—Å–µ —à–∞–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –≤ –ø–æ–ª–Ω–æ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å best practices ClickHouse.
	‚Ä¢	–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ system.numbers ‚Äî —Ö–æ—Ä–æ—à–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ.
	‚Ä¢	SQL-–∑–∞–ø—Ä–æ—Å—ã –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ –∏ —á–∏—Ç–∞–µ–º–æ, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Ç—Ä–µ–±—É–µ–º—ã–µ –∞—Å–ø–µ–∫—Ç—ã: –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ä–æ–ª–∏, –ø—Ä–∞–≤ –∏ –ø—Ä–∏–≤—è–∑–æ–∫.
	‚Ä¢	–§–æ—Ä–º–∞—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —É–¥–æ–±–µ–Ω –∫–∞–∫ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, —Ç–∞–∫ –∏ –¥–ª—è CI-–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ.

‚∏ª

üìå –ö—Ä–∞—Ç–∫–∏–π –∏—Ç–æ–≥

–ó–∞–¥–∞–Ω–∏–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ–µ –≤–ª–∞–¥–µ–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º–æ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º –≤ ClickHouse. –û—Å–≤–æ–µ–Ω—ã –∫–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ RBAC: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Ä–æ–ª–∏, –ø—Ä–∞–≤–∞, –ø—Ä–∏–≤—è–∑–∫–∏. –ú–µ—Ç–æ–¥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–µ—Ä–µ–∑ system.* —Ç–∞–±–ª–∏—Ü—ã –¥–µ–ª–∞–µ—Ç —Ä–∞–±–æ—Ç—É –ø–æ–ª–Ω–æ–π –∏ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É–µ–º–æ–π.


